webpackJsonp([1],{DqPY:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={components:{},data:function(){return{decimals:4,ess_address:essAddress,account_address:"",token_balance:0,token_unit:"",lock_bonus:0,withdraw_bonus:0,lock_percent:"",total_bonus:0,lock_total_bonus:0,bonus_end_time:0,bonus_less_time:0,bonus_less_time_show:"",ico_count:0,token_price:0,token_offered:0,token_less:0,token_start_time:0,token_end_time:0,token_less_time:0,token_less_time_show:"",token_buy_amount:0,ico_start_time:"",ico_end_time:"",ico_price:1e-4,timer:null,bonustimer:null,airdrop_less:0,airdrop_authed_address:"",airdrop_set_address:"",airdrop_price:0,airdrop_pay:0}},mounted:function mounted(){if(!checkweb3())return!1;var _vue=this;window.eventQueue={},window.loopBlock=function(lastblock){web3.eth.getBlockNumber().then(function(newblock){newblock>lastblock?(_vue.load_account(),_vue.load_icoinfo(),web3.eth.getBlock(newblock).then(function(blockinfo){try{for(var i=0;i<blockinfo.transactions.length;i++){var txhash=blockinfo.transactions[i];for(var queuehash in eventQueue)if(txhash==queuehash){var funcname=eventQueue[queuehash];delete eventQueue[queuehash];try{eval(funcname+"('"+txhash+"')")}catch(e){}}}}catch(e){}loopBlock(newblock)})):loopBlock(newblock)})},loopBlock(0),_vue.account_address=window.eth_account,_vue.load_account(),_vue.load_icoinfo()},methods:{send_withdraw:function(){if(!checkweb3())return!1;essContract.methods.withdraw().send({from:eth_account,value:0,gasPrice:web3.utils.toWei("20","gwei")},function(e,t){e||(eventQueue[t]="withdraw_done",window.withdraw_done=function(e){})})},send_setairdropaddress:function(){if(!checkweb3())return!1;essContract.methods.upgradeAirdropAuthAddress(this.airdrop_set_address).send({from:eth_account,value:0,gasPrice:web3.utils.toWei("20","gwei")},function(e,t){e||(eventQueue[t]="setairdropaddress_done",window.setairdropaddress_done=function(e){})})},send_startico:function(){if(!checkweb3())return!1;var e=new Date(this.ico_start_time).getTime()/1e3,t=new Date(this.ico_end_time).getTime()/1e3,o=web3.utils.toWei(this.ico_price.toString(),"ether");essContract.methods.startIco(e,t,o).send({from:eth_account,value:0,gasPrice:web3.utils.toWei("20","gwei")},function(e,t){e||(eventQueue[t]="startico_done",window.startico_done=function(e){})})},send_airdrop:function(){if(!checkweb3())return!1;var e=web3.utils.toWei(this.airdrop_price.toString(),"ether"),t=web3.utils.toWei(this.airdrop_pay.toString(),"ether");essContract.methods.airdrop(e,t).send({from:eth_account,value:0,gasPrice:web3.utils.toWei("20","gwei")},function(e,t){e||(eventQueue[t]="airdrop_done",window.airdrop_done=function(e){})})},send_buy:function(){if(!checkweb3())return!1;var e=this;essContract.methods.icoPrice().call(null,function(t,o){if(!t){var n=o.valueOf(),i=e.token_buy_amount*n;essContract.methods.buy().send({from:eth_account,value:i,gasPrice:web3.utils.toWei("20","gwei")},function(e,t){e||(eventQueue[t]="buy_done",window.buy_done=function(e){})})}})},load_account:function(){var e=this;essContract.methods.balanceOf(e.account_address).call(null,function(t,o){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.token_balance=n,essContract.methods.symbol().call(null,function(t,o){e.token_unit=o.valueOf()}),essContract.methods.totalSupply().call(null,function(t,n){if(0==n)e.lock_percent=0;else{var i=o.valueOf()/n.valueOf()*100;i=Number(i).toFixed(e.decimals),e.lock_percent=i}})}),essContract.methods.lockedBonus(eth_account).call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.lock_bonus=n}}),essContract.methods.withdrawableBonus(eth_account).call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.withdraw_bonus=n}}),web3.eth.getBalance(essAddress).then(function(t){t=web3.utils.fromWei(t.valueOf(),"ether");t=Number(t).toFixed(e.decimals),e.total_bonus=t}),essContract.methods.lockBonusTotal().call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.lock_total_bonus=n}}),essContract.methods.getSettlementTime().call(null,function(t,o){t||(e.bonus_end_time=o.valueOf(),e.bonus_end_time>0&&(window.nowTime=Math.floor((new Date).getTime()/1e3),e.bonus_less_time=e.bonus_end_time-nowTime,e.bonustimer||(e.bonustimer=setInterval(function(){if(e.bonus_less_time--,e.bonus_less_time>=0){var t=e.bonus_less_time,o=Math.floor(t/86400);t%=86400;var n=Math.floor(t/3600);t%=3600;var i=Math.floor(t/60),s=t%60;e.bonus_less_time_show=o+"天"+n+"小时"+i+"分钟"+s+"秒"}},1e3))))}),essContract.methods.airdropTotal().call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.airdrop_less=n}}),essContract.methods.airdropAuthAddress().call(null,function(t,o){t||(e.airdrop_authed_address=o.valueOf())})},load_icoinfo:function(){var e=this;essContract.methods.icoCount().call(null,function(t,o){t||(e.ico_count=o.valueOf())}),essContract.methods.icoPrice().call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.token_price=n}}),essContract.methods.offeredAmount().call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.token_offered=n}}),essContract.methods.icoTotal().call(null,function(t,o){if(!t){var n=web3.utils.fromWei(o.valueOf(),"ether");n=Number(n).toFixed(e.decimals),e.token_less=n}}),essContract.methods.endTime().call(null,function(t,o){t||(e.token_end_time=o.valueOf(),e.token_end_time>0&&(window.nowTime=Math.floor((new Date).getTime()/1e3),e.token_less_time=e.token_end_time-nowTime,e.timer||(e.timer=setInterval(function(){e.token_less_time--;var t=e.token_less_time,o=Math.floor(t/86400);t%=86400;var n=Math.floor(t/3600);t%=3600;var i=Math.floor(t/60),s=t%60;e.token_less_time_show=o+"天"+n+"小时"+i+"分钟"+s+"秒"},1e3))))})}}}},FsUh:function(e,t){},x0vE:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("DqPY"),i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"wrap",staticStyle:{height:"1000px",background:"#eee"}},[e._v("\r\n  \r\n  "+e._s(e.$t("m.public.notice"))+"\r\n\r\n    "),o("el-row",{staticStyle:{margin:"15px"}},[o("el-tag",[e._v("合约地址 "+e._s(e.ess_address))]),o("br"),e._v(" "),o("el-tag",[e._v("当前账户 "+e._s(e.account_address))]),o("br"),e._v(" "),o("el-tag",[e._v("token余额 "+e._s(e.token_balance)+" "+e._s(e.token_unit))]),o("br"),e._v(" "),o("el-tag",[e._v("结算时间"+e._s(e.bonus_less_time_show))]),e._v(" "),o("el-tag",[e._v("锁定分红 "+e._s(e.lock_bonus)+"ETH")]),e._v(" "),o("el-tag",[e._v("可提现 "+e._s(e.withdraw_bonus)+"ETH")]),e._v(" "),o("el-tag",[e._v("占比 "+e._s(e.lock_percent)+"%")]),e._v(" "),o("el-tag",[e._v("分红奖池 "+e._s(Number(e.total_bonus-e.lock_total_bonus).toFixed(e.decimals))+"ETH")]),e._v(" "),o("el-button",{attrs:{disabled:e.withdraw_bonus<=0},on:{click:function(t){e.send_withdraw()}}},[e._v("用户提现")])],1),e._v(" "),o("el-row",{staticStyle:{margin:"15px"}},[o("el-tag",[e._v("第"+e._s(e.ico_count)+"轮 ICO")]),e._v(" "),o("el-tag",[e._v("token价格"+e._s(e.token_price)+"ETH")]),e._v(" "),o("el-tag",[e._v("已售出"+e._s(e.token_offered)+e._s(e.token_unit))]),e._v(" "),o("el-tag",[e._v("剩余"+e._s(e.token_less)+e._s(e.token_unit))]),e._v(" "),o("el-tag",[e._v("剩余时间"+e._s(e.token_less_time_show))]),o("br"),e._v(" "),o("el-input-number",{attrs:{step:1,label:"购买token个数"},model:{value:e.token_buy_amount,callback:function(t){e.token_buy_amount=t},expression:"token_buy_amount"}}),e._v(" "),o("el-button",{on:{click:function(t){e.send_buy()}}},[e._v("购买token")]),o("br"),e._v(" "),o("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.ico_start_time,callback:function(t){e.ico_start_time=t},expression:"ico_start_time"}}),e._v(" "),o("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间"},model:{value:e.ico_end_time,callback:function(t){e.ico_end_time=t},expression:"ico_end_time"}}),e._v(" "),o("el-input-number",{attrs:{min:1e-4,max:10,step:1e-4,label:"每个Token价格(Eth)"},model:{value:e.ico_price,callback:function(t){e.ico_price=t},expression:"ico_price"}}),e._v(" "),o("el-button",{on:{click:function(t){e.send_startico()}}},[e._v("发起ICO")]),o("br")],1),e._v(" "),o("el-row",{staticStyle:{margin:"15px"}},[o("el-tag",[e._v("剩余空投数量"+e._s(e.airdrop_less))]),o("br"),e._v(" "),o("el-tag",[e._v("空投合约地址"+e._s(e.airdrop_authed_address))]),o("br"),e._v(" "),o("el-input",{staticStyle:{width:"435px"},model:{value:e.airdrop_set_address,callback:function(t){e.airdrop_set_address=t},expression:"airdrop_set_address"}}),e._v(" "),o("el-button",{on:{click:function(t){e.send_setairdropaddress()}}},[e._v("设置空投授权地址")]),o("br"),e._v(" "),o("el-tag",[e._v("空投的消费单价")]),o("el-input-number",{attrs:{step:.01,label:"空投的消费单价"},model:{value:e.airdrop_price,callback:function(t){e.airdrop_price=t},expression:"airdrop_price"}}),e._v(" "),o("el-tag",[e._v("空投消费的金额")]),o("el-input-number",{attrs:{step:1,label:"空投消费的金额"},model:{value:e.airdrop_pay,callback:function(t){e.airdrop_pay=t},expression:"airdrop_pay"}}),e._v(" "),o("el-button",{on:{click:function(t){e.send_airdrop()}}},[e._v("空投")]),o("br")],1)],1)},staticRenderFns:[]};var s=function(e){o("FsUh")},a=o("C7Lr")(n.a,i,!1,s,"data-v-589d7a83",null);t.default=a.exports}});